<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml" lang="ja">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>2. プログラムの作成と実行 &#8212; Fortran演習(地球惑星物理学演習)</title>
    
    <link rel="stylesheet" href="_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '2019',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/translations.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="索引" href="genindex.html" />
    <link rel="search" title="検索" href="search.html" />
    <link rel="next" title="3. 変数・データ型・基本的な計算" href="chap03.html" />
    <link rel="prev" title="1. はじめに" href="chap01.html" />
<link rel="stylesheet" type="text/css" href="http://yui.yahooapis.com/3.18.1/build/cssreset/cssreset-min.css">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-99010794-2', 'auto');
  ga('send', 'pageview');

</script>

  </head>
  <body role="document">
    <div class="header-wrapper" role="banner">
      <div class="header">
        <div class="headertitle"><a
          href="index.html">Fortran演習</a></div>
        <div class="rel" role="navigation" aria-label="related navigation">
          <a href="chap01.html" title="1. はじめに"
             accesskey="P">前へ</a> |
          <a href="chap03.html" title="3. 変数・データ型・基本的な計算"
             accesskey="N">次へ</a> |
          <a href="genindex.html" title="総合索引"
             accesskey="I">索引</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="id1">
<h1><a class="toc-backref" href="#id32">2. プログラムの作成と実行</a><a class="headerlink" href="#id1" title="このヘッドラインへのパーマリンク">¶</a></h1>
<p>まずは計算機が実行するプログラムの作成および実行する方法を学び，Fortranプログラムの基本的な構造について理解しよう．</p>
<blockquote>
<div><p>サンプルプログラム</p>
<ul class="simple">
<li><a class="reference internal" href="chap02_sample1_f90.html"><span class="doc">sample1.f90</span></a> : Hello, world</li>
<li><a class="reference internal" href="chap02_sample2_f90.html"><span class="doc">sample2.f90</span></a> : Fortranプログラムの基本構造</li>
<li><a class="reference external" href="sample/chap02/dot.Xmodmap">dot.Xmodmap</a> : CapsLockと左Controlの交換</li>
<li><a class="reference external" href="sample/chap02/dot.emacs.el">dot.emacs.el</a> : emacsの設定</li>
</ul>
</div></blockquote>
<div class="contents topic" id="id2">
<p class="topic-title first">この章の内容</p>
<ul class="simple">
<li><a class="reference internal" href="#id1" id="id32">プログラムの作成と実行</a><ul>
<li><a class="reference internal" href="#hello-world" id="id33">Hello, world !</a></li>
<li><a class="reference internal" href="#id5" id="id34">ソースコードの基本</a></li>
<li><a class="reference internal" href="#id12" id="id35">ソースコード編集にまつわるエトセトラ <sup>†</sup></a></li>
<li><a class="reference internal" href="#id20" id="id36">第2章 演習課題</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="hello-world">
<h2><a class="toc-backref" href="#id33">2.1. Hello, world !</a><a class="headerlink" href="#hello-world" title="このヘッドラインへのパーマリンク">¶</a></h2>
<blockquote>
<div><span class="xref doc">サンプルコード参照</span></div></blockquote>
<p>プログラミング言語を学ぶ時には &#8220;Hello, world !&#8221; を表示するプログラムから始めるのが慣例になっている．以下に示したものがその最初のプログラムである．</p>
<div class="highlight-fortran"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">program </span><span class="n">sample</span>
  <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Hello, world !&#39;</span>
  <span class="k">stop</span>
<span class="k">end program </span><span class="n">sample</span>
</pre></div>
</td></tr></table></div>
<p>これはソースコードと呼ばれ，人間が読める形式で記述されるテキストファイルである．拡張子はFortran 90/95の場合は <code class="docutils literal"><span class="pre">.f90</span></code> とする <a class="footnote-reference" href="#id24" id="id3">[1]</a>．プログラムを実行するには，これをコンパイラと呼ばれるプログラムを用いて実行形式(計算機が読み込んで実行することができる形式)に変換してやる必要がある．これをコンパイルと言う．この演習ではgfortranというコンパイラを用いることにしよう．(Intel製のifortというコンパイラがLinux環境では個人利用では無償で使うことが出来ていたのだが，Intelの方針転換で最近は使えなくなってしまったようだ．) カレントディレクトリに <code class="docutils literal"><span class="pre">sample1.f90</span></code> というファイルがあることを確認して，ターミナルで以下のコマンドを実行しよう．</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ gfortran sample1.f90
$ ./a.out
Hello, world !
</pre></div>
</div>
<p>1行目でgfortranコマンドによってコンパイルを実行している．コンパイルが成功すると <code class="docutils literal"><span class="pre">a.out</span></code> という名前の実行形式のファイルが作成される．2行目で作成された <code class="docutils literal"><span class="pre">a.out</span></code> を実行し，結果が3行目に表示されている．このように&#8221;Hello, world !&#8221;が表示されれば成功である．</p>
<p>ちなみに</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ gfortran sample1.f90 -o hello
</pre></div>
</div>
<p>のように <code class="docutils literal"><span class="pre">-o</span></code> オプションを使って作成される実行形式のファイル名を指定することが出来る．上の場合は <code class="docutils literal"><span class="pre">hello</span></code> というファイルが作成されるのでこれを実行すると先ほどと同じ結果が得られるはずである．なおコンパイラに渡すことの出来るオプションは他にも山ほど存在するので，興味がある人は</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ man gfortran
</pre></div>
</div>
<p>で調べて欲しい．まあよく使うようなオプションはせいぜい数個程度であろう．このように，どんなプログラムであっても基本的にはemacsやvi等のエディタでソースコードを編集し，コンパイル，最後に実行という流れになる <a class="footnote-reference" href="#id25" id="id4">[2]</a>．</p>
</div>
<div class="section" id="id5">
<h2><a class="toc-backref" href="#id34">2.2. ソースコードの基本</a><a class="headerlink" href="#id5" title="このヘッドラインへのパーマリンク">¶</a></h2>
<blockquote>
<div><span class="xref doc">サンプルコード参照</span></div></blockquote>
<p>以下に示すサンプルを例にとってFortranのソースコードの基本的な構造を説明しよう．</p>
<div class="highlight-fortran"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c">! これ以降は「コメント」として無視される.</span>
<span class="c">! ソースコードは人間が直感的に理解できないので, 適宜コメントを入れてプログラムの</span>
<span class="c">! 内容を理解しやすくすることを推奨.</span>
<span class="c">! 日本語も入力できるが, 環境によっては文字化けする可能性がある.</span>

<span class="k">program </span><span class="n">sample</span> <span class="c">! ここにコメントを書いても良い</span>
  <span class="c">! 空行は無視される</span>

  <span class="c">! 標準出力に文字列を表示(シングルクオートもしくはダブルクオートで囲む）</span>
  <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Hello, world 2 !&#39;</span>

  <span class="c">! 複数の文字列や変数をカンマで区切って並べてもよい</span>
  <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s2">&quot;This is &quot;</span><span class="p">,</span> <span class="s2">&quot;also &quot;</span><span class="p">,</span> <span class="s2">&quot;OK&quot;</span>

  <span class="c">! 1文が複数行に渡る場合には `&amp;` を用いる.</span>
  <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="p">&amp;</span>
       <span class="p">&amp;</span> <span class="s1">&#39;This is a continuation line&#39;</span>

  <span class="c">! プログラムを終了する. 多くの場合無くても構わないがあったほうが無難.</span>
  <span class="k">stop</span>
<span class="k">end program </span><span class="n">sample</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="id6">
<h3>2.2.1. 使用可能な文字<a class="headerlink" href="#id6" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>ソースコードの編集に用いることが出来るのは半角の英数字および下線(アンダースコア)といくつかの四則演算などに使う特殊文字である．(要するに日本語は使えないと思えば良い．) なおFortranは英字の大文字と小文字を区別しない( <code class="docutils literal"><span class="pre">fortran</span></code>，<code class="docutils literal"><span class="pre">Fortran</span></code>，<code class="docutils literal"><span class="pre">FORTRAN</span></code> は全て同一と解釈される)という現代においては大変珍しい言語の一つである．これは歴史的な事情によるものである．古いFortran 77のソースコードには大文字だけで記述されているものも多く存在するが，単に読みにくくなるだけなのでそのような意味のないことはやめよう．</p>
</div>
<div class="section" id="id7">
<h3>2.2.2. コメント<a class="headerlink" href="#id7" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>ソースコードには計算機に実行させる命令だけでなくコメント(注釈)を含めることができる．Fortranでは &#8221;!&#8221; から行末までがコメントとみなされる．コメントはプログラムの実行とは無関係であり，コンパイル時には単純に無視される．ソースコードはプログラミング言語固有のキーワードなどで記述されているため人間には理解しづらいのに対して，コメントには人間が理解できるように自由に説明を加えることができる．コメントはソースコードの可読性を良くするものなので積極的に活用すべきである <a class="footnote-reference" href="#id26" id="id8">[3]</a>．なおコメントには日本語を用いても問題ないが，それ以外の部分に日本語を使うとコンパイル時にエラーとなる．特に気づきにくいのがソースコード中に全角スペースが混じってしまってコンパイルが通らないという現象である．エディタにemacsを用いている場合は，後に見るように設定によってこの問題を回避出来る．</p>
</div>
<div class="section" id="id9">
<h3>2.2.3. プログラムの構造<a class="headerlink" href="#id9" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Fortranのソースコードは以下のように <code class="docutils literal"><span class="pre">program</span></code> と <code class="docutils literal"><span class="pre">end</span> <span class="pre">program</span></code> で囲まれる．以下のコードの <code class="docutils literal"><span class="pre">program_name</span></code> は基本的に何でも良く，分り易い名前を付けるのがよい．ただしFortranの予約語( <code class="docutils literal"><span class="pre">program</span></code> などのキーワード)は使えない．また後述の組込み関数と同じ名前にしてしまうとその組込み関数は使えなくなってしまうので注意して欲しい．<code class="docutils literal"><span class="pre">stop</span></code> はプログラムを終了するという意味であり，<code class="docutils literal"><span class="pre">end</span> <span class="pre">program</span></code> の直前では省略しても通常は問題無いのだが，入れておいた方がお行儀が良いのでそうしておこう．</p>
<div class="highlight-fortran"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">program </span><span class="n">program_name</span>

  <span class="c">! ここに処理を記述する</span>

  <span class="k">stop</span>
<span class="k">end program </span><span class="n">program_name</span>
</pre></div>
</td></tr></table></div>
<p>また</p>
<div class="highlight-fortran"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;This will be printed out to the termnal.&#39;</span>
</pre></div>
</td></tr></table></div>
<p>とすると標準出力(ターミナル)に文字列を表示することができる．<code class="docutils literal"><span class="pre">write(*,*)</span></code> はここではとりあえず文字列を出力するためのオマジナイと思っておいて欲しい．プログラミング言語を学ぶ時にはこの「オマジナイ」というやつが多く出てくるのだが，そのうち意味がわかるようになるので心配しなくて良い．なお <code class="docutils literal"><span class="pre">read(*,*)</span></code> で標準入力(ターミナルからのキーボード入力)を読み込むことが出来るが，これについては変数を学んでから説明しよう．なお先ほどのサンプルの13行目の様に複数の文字列や後で説明する変数をカンマで区切って並べても良い．これを入出力リストと呼ぶ．</p>
</div>
<div class="section" id="id10">
<h3>2.2.4. 継続行<a class="headerlink" href="#id10" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Fortranでは1行が132文字以下でなければいけないという制限が課せられている．1行に収まらない長い文を記述するには行の最後に <code class="docutils literal"><span class="pre">&amp;</span></code> を記述することで，次の行へと継続することが出来る．実際には80文字とか100文字とか(要するにエディタの表示範囲で)改行する方がプログラムが読みやすくなる．サンプルの16-17行目のような形で記述すればよい．17行目の <code class="docutils literal"><span class="pre">&amp;</span></code> は必ずしも必要では無いが，あった方が読みやすいので入れておくことを推奨する．なおemacsでは改行したい位置で <code class="docutils literal"><span class="pre">C-c</span> <span class="pre">RET</span></code> と打つと <code class="docutils literal"><span class="pre">&amp;</span></code> を自動で挿入して字下げまでしてくれる <a class="footnote-reference" href="#id27" id="id11">[4]</a>．</p>
</div>
</div>
<div class="section" id="id12">
<h2><a class="toc-backref" href="#id35">2.3. ソースコード編集にまつわるエトセトラ <sup>†</sup></a><a class="headerlink" href="#id12" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>ソースコードの編集に用いるソフトウェアはテキスト形式のファイルが編集できるものであればどんなものであっても構わない．しかし世の中には専用に開発された便利なものがあるので利用しない手は無い．この演習ではemacsの使用を推奨することにする．Visual Studio や Eclipse などを使ったことのある人にはビックリするほど簡易な環境ではあるが，リモートマシンでソースコードの編集をする機会が多い人間にはその方が良いのである．ちなみに emacs はそのようないわゆる統合開発環境に負けないくらいの機能も有している．ただ単に使いこなすのが難しいだけなので，興味のある人は自分でどんどん調べてカスタマイズしていくと良い．</p>
<p>以下ではemacsで(Fortranに限らず)ソースコードを編集する際に知っておいた方が良いことや，便利な設定などをほんの一部だけ紹介する．知らなくても効率が悪くなるだけで何かが出来なくなるわけではないので興味のない人は無視してもらって構わない．</p>
<div class="section" id="control-capslock-setxkbmap">
<h3>2.3.1. <code class="docutils literal"><span class="pre">Control</span></code> と <code class="docutils literal"><span class="pre">CapsLock</span></code> の交換 (setxkbmap)<a class="headerlink" href="#control-capslock-setxkbmap" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>まずemacsでは <code class="docutils literal"><span class="pre">Control</span></code> をかなり多様するので <code class="docutils literal"><span class="pre">A</span></code> のキーの左の <code class="docutils literal"><span class="pre">CapsLock</span></code> を <code class="docutils literal"><span class="pre">Control</span></code> と交換して使用する人がほとんどである(多分)．最近のLinux系のOS環境では <code class="docutils literal"><span class="pre">CapsLock</span></code> と <code class="docutils literal"><span class="pre">Control</span></code> を交換するには</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ setxkbmap -option ctrl:swapcaps
</pre></div>
</div>
<p>とするのが手っ取り早い．</p>
<p>このコマンドをログイン時に自動で実行して欲しいわけだが，これには <code class="docutils literal"><span class="pre">~/.xsession</span></code> や <code class="docutils literal"><span class="pre">~/.xinitrc</span></code> などのファイルに上記のコマンドを書き込むことで実現出来ることが多い．ただし自動実行の設定は環境依存の話であるので自分の環境に合わせて適宜やり方を調べて欲しい．またこのようなキーボードのカスタマイズの仕方は他にも複数の方法があるので必要な人は自分で調べてみよう．</p>
<p>なお，同様にviユーザーは <code class="docutils literal"><span class="pre">Escape</span></code> を多用するのでスペースキーの左もしくは右のキー(普通の日本語キーボードでは「無変換」とか「変換」)を <code class="docutils literal"><span class="pre">Escape</span></code> として使う人が多いようである．</p>
</div>
<div class="section" id="control-capslock">
<h3>2.3.2. <code class="docutils literal"><span class="pre">Control</span></code> と <code class="docutils literal"><span class="pre">CapsLock</span></code> の交換 (古い方法)<a class="headerlink" href="#control-capslock" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>以下の方法は古典的な方法で，最近の環境では必要ない(というか紛らわしい)情報かもしれないが，念のため残しておく．</p>
<p>Linux系の環境では <code class="docutils literal"><span class="pre">xmodmap</span></code> というコマンドでキーボードのカスタマイズが出来る．ホームディレクトリに <code class="docutils literal"><span class="pre">.Xmodmap</span></code> というファイルを作り，以下の様な内容で保存する．</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>remove <span class="nv">Lock</span> <span class="o">=</span> Caps_Lock
remove <span class="nv">Control</span> <span class="o">=</span> Control_L
keycode <span class="nv">37</span> <span class="o">=</span> Caps_Lock
keycode <span class="nv">66</span> <span class="o">=</span> Control_L
add <span class="nv">Lock</span> <span class="o">=</span> Caps_Lock
add <span class="nv">Control</span> <span class="o">=</span> Control_L
</pre></div>
</div>
<p>そして</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ xmodmap ~/.Xmodmap
</pre></div>
</div>
<p>というコマンドを実行すると <code class="docutils literal"><span class="pre">CapsLock</span></code> と 左の <code class="docutils literal"><span class="pre">Control</span></code> キーが交換されたハズだ．ログイン時に自動でこのコマンドを実行するように設定しておけば便利である．</p>
</div>
<div class="section" id="id13">
<h3>2.3.3. 基本的な編集作業<a class="headerlink" href="#id13" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>まずマウスを使わずに作業できるようになることを目標にしよう．なぜなら将来リモートマシンにログインして作業する際にはマウスを使うことは出来ないからだ <a class="footnote-reference" href="#id28" id="id14">[5]</a>．</p>
<p>既にこれまでの演習で学んだことだとは思うがemacsでは( <code class="docutils literal"><span class="pre">Control</span></code> キーと <code class="docutils literal"><span class="pre">CapsLock</span></code> を交換しておけば)キーボードのホームポジションから手を動かさずに全ての作業が出来るようになっている．これにはカーソルキーに対応する <code class="docutils literal"><span class="pre">C-n</span></code> (↓ <code class="docutils literal"><span class="pre">next-line</span></code>)，<code class="docutils literal"><span class="pre">C-p</span></code> (↑ <code class="docutils literal"><span class="pre">previous-line</span></code>)，<code class="docutils literal"><span class="pre">C-f</span></code> (→ <code class="docutils literal"><span class="pre">forward-char</span></code>)，<code class="docutils literal"><span class="pre">C-b</span></code> (← <code class="docutils literal"><span class="pre">backward-char</span></code>)，と <code class="docutils literal"><span class="pre">Delete</span></code> キーに対応する <code class="docutils literal"><span class="pre">C-h</span></code> は必須である．また <code class="docutils literal"><span class="pre">C-a</span></code> (行頭へ移動)，<code class="docutils literal"><span class="pre">C-e</span></code> (行末へ移動) や，<code class="docutils literal"><span class="pre">C-k</span></code> (カーソルから行末までを削除) もよく使うので覚えておこう．ちなみにemacsとは関係無いが，多くの環境で Alt-Tabによってウィンドウの切り替えが出来る．またターミナルでのコマンドライン編集時にもemacsと同じキーバインドが使える場合が多いので，これらを覚えておくだけでマウスの使用頻度が激減すること請け合いである．</p>
<p>viユーザーの名誉のために述べておくと，当然のようにviでも( <code class="docutils literal"><span class="pre">Escape</span></code> の場所を適切にしておけば)ホームポジションから一切手を動かす必要が無い．更に言うとviでは片手でコーヒーを飲みながらカーソル移動が出来るので，少なくともこの点ではviの方が優れている(なので余裕があればviも勉強しよう)．</p>
</div>
<div class="section" id="tab">
<h3>2.3.4. Tabの利用<a class="headerlink" href="#tab" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>ソースコードは適切に字下げされていると格段に見やすくなるし，明らかな文法間違いに気づくきっかけにもなるので字下げの徹底を強く推奨する．emacsでは Tabキーを押すと自動でカーソルのある行の字下げをしてくれる．複数行を一気に字下げしたい場合には字下げしたい領域を選択して <code class="docutils literal"><span class="pre">M-x</span> <span class="pre">indent-region</span></code> もしくは <code class="docutils literal"><span class="pre">M-C-\</span></code> で選択された領域の字下げが出来る．ファイル全体を字下げしたい時には <code class="docutils literal"><span class="pre">C-x</span> <span class="pre">h</span> <span class="pre">M-C-\</span></code> とすれば良い．</p>
<p>またFortranは <code class="docutils literal"><span class="pre">program</span></code> に限らず，実行ブロックが <code class="docutils literal"><span class="pre">end</span> <span class="pre">???</span></code> で終わるようになっている．emacsでは <code class="docutils literal"><span class="pre">end</span></code> まで入力した状態でTabキーを押すと自動で <code class="docutils literal"><span class="pre">end</span></code> の後に適切なキーワードを挿入してくれる．(例えば <code class="docutils literal"><span class="pre">program</span> <span class="pre">sample</span></code> の場合はTabキーによって <code class="docutils literal"><span class="pre">end</span></code> の後に <code class="docutils literal"><span class="pre">program</span> <span class="pre">sample</span></code> が挿入される．) これは非常に便利なので是非利用して欲しい．</p>
</div>
<div class="section" id="id15">
<h3>2.3.5. コメントアウト<a class="headerlink" href="#id15" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>ソースコードを編集していると(特にデバッグ中は)複数行をまとめてコメントアウトしたいことが多々ある．そんな時に各行の先頭にいちいち&#8221;!&#8221;を挿入するのはバカバカしい．emacsでは領域を選択して <code class="docutils literal"><span class="pre">M-x</span> <span class="pre">comment-region</span></code> とするとまとめてコメントアウトしてくれるようになっている．ちなみにコメントアウトした領域を元に戻す時は <code class="docutils literal"><span class="pre">M-x</span> <span class="pre">uncomment-region</span></code> とすれば良い．なお多くのemacsのデフォルト環境で <code class="docutils literal"><span class="pre">.f90</span></code> のファイルを開いた場合には(自動でf90-modeというモードになり) <code class="docutils literal"><span class="pre">C-;</span></code> が <code class="docutils literal"><span class="pre">M-x</span> <span class="pre">comment-region</span></code> に設定されている．同様に <code class="docutils literal"><span class="pre">C-u</span> <span class="pre">C-;</span></code> が <code class="docutils literal"><span class="pre">M-x</span> <span class="pre">uncomment-region</span></code> である．</p>
</div>
<div class="section" id="id16">
<h3>2.3.6. 全角スペースの表示<a class="headerlink" href="#id16" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>前述の通りソースコードに全角スペースが含まれているとコンパイルが出来ない(しかもエラーメッセージからはそれが分からない)という厄介な問題が存在する．これは初心者ほど陥りやすい罠であるが，emacsの設定でこの問題を回避することが出来る．例えば以下の様な設定を <code class="docutils literal"><span class="pre">.emacs</span></code> などの設定ファイルに書いておくと全角スペースが &#8220;□&#8221; と表示されるので一目瞭然である．</p>
<div class="highlight-elisp"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">require</span> <span class="ss">&#39;whitespace</span><span class="p">)</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">whitespace-style</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">face</span> <span class="nv">trailing</span> <span class="nv">spaces</span> <span class="nv">tabs</span> <span class="nv">space-mark</span> <span class="nv">tab-mark</span><span class="p">))</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">whitespace-space-regexp</span> <span class="s">&quot;\\(\x3000+\\)&quot;</span><span class="p">)</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">whitespace-display-mappings</span>
      <span class="o">&#39;</span><span class="p">((</span><span class="nv">space-mark</span> <span class="sc">?\x</span><span class="mi">3000</span> <span class="p">[</span><span class="sc">?\□</span><span class="p">])</span>
        <span class="p">(</span><span class="nv">tab-mark</span>   <span class="sc">?\t</span>   <span class="p">[</span><span class="sc">?\x</span><span class="nv">BB</span> <span class="sc">?\t</span><span class="p">])</span>
        <span class="p">))</span>
<span class="p">(</span><span class="nv">set-face-attribute</span> <span class="ss">&#39;whitespace-trailing</span> <span class="no">nil</span>
                    <span class="nb">:background</span> <span class="s">&quot;navy&quot;</span><span class="p">)</span>
<span class="p">(</span><span class="nv">global-whitespace-mode</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>なお上の設定では行末のスペースやタブなども表示するように設定されているが，このあたりは完全に好みである．以下はemacsでソースコードを編集中のスクリーンショットである．</p>
<div class="figure align-center" id="id30">
<a class="reference internal image-reference" href="_images/emacs.png"><img alt="_images/emacs.png" src="_images/emacs.png" style="width: 480px;" /></a>
<p class="caption"><span class="caption-text">Emacsのスクリーンショット</span></p>
</div>
</div>
<div class="section" id="id17">
<h3>2.3.7. 複数ファイルの編集<a class="headerlink" href="#id17" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>真のemacs使いはいちいちemacsを立ち上げたり終了したりはしない．常にemacsを立ち上げておき，複数のファイル(emacsではバッファと呼ぶ)を縦横無尽に切り替えながら編集するのである <a class="footnote-reference" href="#id29" id="id18">[6]</a>．<code class="docutils literal"><span class="pre">C-x</span> <span class="pre">f</span></code> で新しいファイルを開くことは当然出来るとして，過去に編集していたバッファに切り替える方法を覚えておこう．<code class="docutils literal"><span class="pre">C-x</span> <span class="pre">b</span></code> でミニバッファに既に開いているバッファ名(ファイル名)を入力するとそのバッファに移ることが出来る．またTabによる補完も使うことが出来る．<code class="docutils literal"><span class="pre">C-x</span> <span class="pre">C-b</span></code> では現在開いているバッファの一覧が表示され，選択することでそのバッファに移ることが出来る．</p>
<p>なお最近ではemacsにもタブ(タブブラウザのあれである)を導入することが出来るらしい．興味のある人は <code class="docutils literal"><span class="pre">tabbar.el</span></code> で調べてみよう．</p>
</div>
<div class="section" id="id19">
<h3>2.3.8. まとめ<a class="headerlink" href="#id19" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>細かいことはどうでもいいという実践派の人は以下の表を頭に入れておけばよい．正確には体が勝手に覚えるものなのだが．</p>
<table border="1" class="colwidths-given docutils" id="id31">
<caption><span class="caption-text">これだけは知っとけemacsのキーバインド</span><a class="headerlink" href="#id31" title="このテーブルへのパーマリンク">¶</a></caption>
<colgroup>
<col width="33%" />
<col width="67%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">キーバインド</th>
<th class="head">説明</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">C-p</span></code></td>
<td>上へ移動</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">C-n</span></code></td>
<td>下へ移動</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">C-f</span></code></td>
<td>右へ移動</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">C-b</span></code></td>
<td>左へ移動</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">C-a</span></code></td>
<td>行頭へ移動</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">C-e</span></code></td>
<td>行末へ移動</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">C-h</span></code></td>
<td><code class="docutils literal"><span class="pre">Delete</span></code></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">C-k</span></code></td>
<td>カーソル位置から行末までを削除</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">C-&#64;</span></code>/<code class="docutils literal"><span class="pre">C-space</span></code></td>
<td>領域選択を開始</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">C-w</span></code></td>
<td>選択範囲を切り取り</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">M-w</span></code></td>
<td>選択範囲をコピー</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">C-y</span></code></td>
<td>コピーした内容を貼り付け</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">C-c</span> <span class="pre">;</span></code></td>
<td>選択領域をコメントアウト</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">C-u</span> <span class="pre">C-;</span></code></td>
<td>選択されたコメントアウトされている領域のコメントを外す</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">C-c</span> <span class="pre">RET</span></code></td>
<td>継続行の挿入</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">M-C-\</span></code></td>
<td>選択された領域の字下げ</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">C-x</span> <span class="pre">h</span> <span class="pre">M-C-\</span></code></td>
<td>ファイルの全てを選択して字下げ</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">C-x</span> <span class="pre">f</span></code></td>
<td>ファイルを開く</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">C-x</span> <span class="pre">b</span></code></td>
<td>バッファの切替え</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">C-x</span> <span class="pre">C-b</span></code></td>
<td>バッファ一覧の表示</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">C-s</span></code></td>
<td>前方検索</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">C-r</span></code></td>
<td>後方検索</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">M-%</span></code></td>
<td>置換(置換前にその都度確認をする)</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="id20">
<h2><a class="toc-backref" href="#id36">2.4. 第2章 演習課題</a><a class="headerlink" href="#id20" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="section" id="id21">
<h3>2.4.1. 課題1<a class="headerlink" href="#id21" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>サンプルプログラムをコンパイル・実行して動作を確認せよ．</p>
</div>
<div class="section" id="id22">
<h3>2.4.2. 課題2<a class="headerlink" href="#id22" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>サンプルプログラムをエディタで修正，コンパイルし、実行して結果を確認せよ．例えば <a class="reference internal" href="chap02_sample1_f90.html"><span class="doc">sample1.f90</span></a> の出力を <code class="docutils literal"><span class="pre">Hello,</span> <span class="pre">Fortran</span> <span class="pre">!</span></code> に変更して出力を確認せよ．</p>
</div>
<div class="section" id="id23">
<h3>2.4.3. 課題3 <sup>†</sup><a class="headerlink" href="#id23" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>本演習では扱わないが，C言語やPythonの場合についてもプログラムの実行の方法も知っておこう．</p>
<p>C言語はFortranと同じようにコンパイル言語なので，ソースをコンパイルして実行する．C言語のコンパイラとしては <code class="docutils literal"><span class="pre">gcc</span></code> を用いることが出来る．ここでは <a class="reference internal" href="chap02_hello_c.html"><span class="doc">hello.c</span></a> をコンパイル，実行してみよう．</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ gcc hello.c
$ ./a.out
Hello, world !
</pre></div>
</div>
<p>このように，コンパイラのコマンドとして <code class="docutils literal"><span class="pre">gcc</span></code> を使うこと以外は基本的に同じである．</p>
<p>Pythonはスクリプト言語と呼ばれ，コンパイルが必要なく，直接ソースから実行することが出来る．ここでは <a class="reference internal" href="chap02_hello_py.html"><span class="doc">hello.py</span></a> を実行してみよう．</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ ./hello.py
Hello, world !
</pre></div>
</div>
<p>プログラムの規模が大きくなってくると，次第にコンパイルにも時間がかかるようになってくるが，Pythonのような言語ではコンパイルの必要がないことが大きな利点となる．一方で実行速度は（書き方に大きく依存するものの）C言語やFortranの方が一般には高速である．</p>
<hr class="docutils" />
<table class="docutils footnote" frame="void" id="id24" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[1]</a></td><td>Fortran 77では <code class="docutils literal"><span class="pre">.f</span></code> である．</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id25" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[2]</a></td><td>そうでない場合もあるのだが，とりあえず今は気にしないことにしよう．</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id26" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id8">[3]</a></td><td>自分が3日前に書いたコードが何をしているか理解できないというのは日常茶飯事である．</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id27" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id11">[4]</a></td><td>このようにキーバインドを表す際には <code class="docutils literal"><span class="pre">C</span></code> がControl，<code class="docutils literal"><span class="pre">M</span></code> がMetaキーを表す．例えば <code class="docutils literal"><span class="pre">C-x</span></code> はControlキーを押しながら <code class="docutils literal"><span class="pre">x</span></code> キーを押すことを，<code class="docutils literal"><span class="pre">M-x</span></code> はEscapeキーを押して <em>離してから</em> <code class="docutils literal"><span class="pre">x</span></code> キーを押すことを意味する．</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id28" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id14">[5]</a></td><td>出来ないことも無いのだが，やっぱり何をするのにも遅くてイライラするので．</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id29" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id18">[6]</a></td><td>emacs上でコンパイルしたり，emacsをターミナル代わりに使う人もいるのだが少しばかりマニアックな話題なので各自で調べて欲しい．</td></tr>
</tbody>
</table>
</div>
</div>
</div>


          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>目次</h3>
          <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="chap01.html">1. はじめに</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">2. プログラムの作成と実行</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#hello-world">2.1. Hello, world !</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id5">2.2. ソースコードの基本</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id12">2.3. ソースコード編集にまつわるエトセトラ <sup>†</sup></a></li>
<li class="toctree-l2"><a class="reference internal" href="#id20">2.4. 第2章 演習課題</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="chap03.html">3. 変数・データ型・基本的な計算</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap04.html">4. 制御構造</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap05.html">5. 配列</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap06.html">6. 書式指定・ファイル入出力・文字列処理</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap07.html">7. 関数とサブルーチン</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap08.html">8. 数値解析の基礎</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap09.html">9. モジュールと構造型</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap10.html">10. 付録</a></li>
</ul>

          <div role="search">
            <h3 style="margin-top: 1.5em;">検索</h3>
            <form class="search" action="search.html" method="get">
                <input type="text" name="q" />
                <input type="submit" value="検索" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
            </form>
          </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <div role="navigation" aria-label="related navigaton">
            <a href="chap01.html" title="1. はじめに"
              >前へ</a> |
            <a href="chap03.html" title="3. 変数・データ型・基本的な計算"
              >次へ</a> |
            <a href="genindex.html" title="総合索引"
              >索引</a>
          </div>
          <div role="note" aria-label="source link">
          </div>
        </div>

        <div class="right">
          
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, Takanobu Amano.
      このドキュメントは <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.6 で生成しました。
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>