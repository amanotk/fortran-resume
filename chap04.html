

<!doctype html>

<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <title>4. 制御構造 &#8212; Fortran演習(地球惑星物理学演習)</title>
    <link rel="stylesheet" href="_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/translations.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="_static/bizstyle.js"></script>
    <link rel="index" title="索引" href="genindex.html" />
    <link rel="search" title="検索" href="search.html" />
    <link rel="next" title="5. 配列" href="chap05.html" />
    <link rel="prev" title="3. 変数・データ型・基本的な計算" href="chap03.html" />
<link rel="stylesheet" type="text/css" href="http://yui.yahooapis.com/3.18.1/build/cssreset/cssreset-min.css">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-99010794-2', 'auto');
  ga('send', 'pageview');

</script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="総合索引"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="chap05.html" title="5. 配列"
             accesskey="N">次へ</a> |</li>
        <li class="right" >
          <a href="chap03.html" title="3. 変数・データ型・基本的な計算"
             accesskey="P">前へ</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Fortran演習</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">目次</a></h3>
  <ul>
<li><a class="reference internal" href="#">4. 制御構造</a><ul>
<li><a class="reference internal" href="#if">4.1. 条件分岐(if)</a></li>
<li><a class="reference internal" href="#do">4.2. 反復処理(do)</a><ul>
<li><a class="reference internal" href="#c4-do">4.2.1. 決まった回数の繰り返し(do)</a></li>
<li><a class="reference internal" href="#do-while">4.2.2. 条件を指定した繰り返し(do while)</a></li>
<li><a class="reference internal" href="#exitcycle">4.2.3. 複雑な処理(exitとcycle)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#select">4.3. 条件分岐(select)</a></li>
<li><a class="reference internal" href="#id5">4.4. 第4章 演習課題</a><ul>
<li><a class="reference internal" href="#id6">4.4.1. 課題1</a></li>
<li><a class="reference internal" href="#id7">4.4.2. 課題2</a></li>
<li><a class="reference internal" href="#id8">4.4.3. 課題3</a></li>
<li><a class="reference internal" href="#id9">4.4.4. 課題4</a></li>
<li><a class="reference internal" href="#id10">4.4.5. 課題5</a></li>
<li><a class="reference internal" href="#id11">4.4.6. 課題6</a></li>
<li><a class="reference internal" href="#id12">4.4.7. 課題7</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>前のトピックへ</h4>
  <p class="topless"><a href="chap03.html"
                        title="前の章へ"><span class="section-number">3. </span>変数・データ型・基本的な計算</a></p>
  <h4>次のトピックへ</h4>
  <p class="topless"><a href="chap05.html"
                        title="次の章へ"><span class="section-number">5. </span>配列</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">クイック検索</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="検索" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="id1">
<h1><a class="toc-backref" href="#id27"><span class="section-number">4. </span>制御構造</a><a class="headerlink" href="#id1" title="このヘッドラインへのパーマリンク">¶</a></h1>
<p>ここではプログラムの動作を制御するための文法について学ぼう．と言っても覚えなければいけないことは <code class="docutils literal notranslate"><span class="pre">if</span></code> による条件分岐，<code class="docutils literal notranslate"><span class="pre">do</span></code> による繰り返し，<code class="docutils literal notranslate"><span class="pre">select</span></code> による条件分岐のみである．<code class="docutils literal notranslate"><span class="pre">goto</span></code> という構文も存在するのだが，これはバグのもとになることから一般的には使わないほうが良いとされており，従ってここでも敢えて扱わない．</p>
<blockquote>
<div><p>サンプルプログラム</p>
<ul class="simple">
<li><p><a class="reference internal" href="chap04_sample1_f90.html"><span class="doc">sample1.f90</span></a> : 条件分岐(if)</p></li>
<li><p><a class="reference internal" href="chap04_sample2_f90.html"><span class="doc">sample2.f90</span></a> : 反復処理(doループ1)</p></li>
<li><p><a class="reference internal" href="chap04_sample3_f90.html"><span class="doc">sample3.f90</span></a> : 反復処理(doループ2)</p></li>
<li><p><a class="reference internal" href="chap04_sample4_f90.html"><span class="doc">sample4.f90</span></a> : 反復処理(doループ3)</p></li>
<li><p><a class="reference internal" href="chap04_sample5_f90.html"><span class="doc">sample5.f90</span></a> : 条件分岐(select)</p></li>
</ul>
</div></blockquote>
<div class="contents topic" id="id2">
<p class="topic-title">この章の内容</p>
<ul class="simple">
<li><p><a class="reference internal" href="#id1" id="id27">制御構造</a></p>
<ul>
<li><p><a class="reference internal" href="#if" id="id28">条件分岐(if)</a></p></li>
<li><p><a class="reference internal" href="#do" id="id29">反復処理(do)</a></p></li>
<li><p><a class="reference internal" href="#select" id="id30">条件分岐(select)</a></p></li>
<li><p><a class="reference internal" href="#id5" id="id31">第4章 演習課題</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="if">
<h2><a class="toc-backref" href="#id28"><span class="section-number">4.1. </span>条件分岐(if)</a><a class="headerlink" href="#if" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">if</span></code> による条件分岐は例えばユーザーの入力によって動作を変更する場合などに用いる．典型的な使い方は以下のようなものである．（これは閏年の判定例である．）</p>
<div class="literal-block-wrapper docutils container" id="id14">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="chap04_sample1_f90.html"><span class="doc">sample1.f90</span></a> 抜粋</span><a class="headerlink" href="#id14" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-fortran notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="highlight"><pre><span></span>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">year</span>

  <span class="c">! 標準入力から整数を読み込む</span>
  <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Input year: &#39;</span>
  <span class="k">read</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">year</span>

  <span class="c">! 基本的なifによる分岐</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">mod</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">     write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Leap year&#39;</span>
  <span class="k">else if</span> <span class="p">(</span><span class="nb">mod</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">     write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Common year&#39;</span>
  <span class="k">else if</span> <span class="p">(</span><span class="nb">mod</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">     write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Leap year&#39;</span>
  <span class="k">else</span>
<span class="k">     write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Common year&#39;</span>
  <span class="k">end if</span>
</pre></div>
</td></tr></table></div>
</div>
<p>このように <code class="docutils literal notranslate"><span class="pre">if</span></code> に続く <code class="docutils literal notranslate"><span class="pre">()</span></code> の中に条件式(conditional)を記述し，その条件が真( <code class="docutils literal notranslate"><span class="pre">.true.</span></code>)の時には <code class="docutils literal notranslate"><span class="pre">then</span></code> に続く処理が実行され，偽( <code class="docutils literal notranslate"><span class="pre">.false.</span></code>)の時には <code class="docutils literal notranslate"><span class="pre">else</span> <span class="pre">if</span></code> または <code class="docutils literal notranslate"><span class="pre">else</span></code> で更に条件判定をすることになる．また</p>
<div class="highlight-fortran notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">if</span><span class="p">(</span> <span class="n">conditional</span> <span class="p">)</span> <span class="k">then</span>
  <span class="c">! 処理</span>
<span class="k">end if</span>
</pre></div>
</td></tr></table></div>
<p>や</p>
<div class="highlight-fortran notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">if</span><span class="p">(</span> <span class="n">conditional</span> <span class="p">)</span> <span class="k">then</span>
  <span class="c">! 処理1</span>
<span class="k">else</span>
  <span class="c">! 処理2</span>
<span class="k">end if</span>
</pre></div>
</td></tr></table></div>
<p>のように書くことも出来る．構文自体はそれほど難しくないので，ここで注意すべきは条件判定の部分だけであろう．以下の表に条件式に用いられることの多い演算子をまとめてある．なおFortran 77では <code class="docutils literal notranslate"><span class="pre">&gt;</span></code> のような演算子(関係演算子と呼ばれる)は正式にはサポートされていなかった．このため古いコードには <code class="docutils literal notranslate"><span class="pre">.gt.</span></code> のような演算子を見かけることもあるかも知れないが，自分で新しくプログラムを作成する際にはこのような古い形式は使うべきではない．新しい形式は <code class="docutils literal notranslate"><span class="pre">/=</span></code> 以外のものについてはC言語を始めとする他の多くの言語と同じなのでこちらを用いることを強く推奨する．ちなみにC言語などでは <code class="docutils literal notranslate"><span class="pre">/=</span></code> ではなく <code class="docutils literal notranslate"><span class="pre">!=</span></code> が用いられる．</p>
<p>特に実数の値が等しいかどうかを判定する際には注意が必要である．すなわち，実数に対しては <code class="docutils literal notranslate"><span class="pre">==</span></code> を使うことは出来ない．なぜなら2つの実数がほぼ等しいように見えても <code class="docutils literal notranslate"><span class="pre">==</span></code> による判定では全てのビットが厳密に等しくなければ真とは判定されないからである．従って，代わりに例えば差の絶対値 <code class="docutils literal notranslate"><span class="pre">abs(A-B)</span></code> が十分小さいかどうかで判定しなくてはならない <a class="footnote-reference brackets" href="#id13" id="id3">1</a>．</p>
<table class="colwidths-given docutils align-default" id="id15" style="width: 80%">
<caption><span class="caption-text">条件演算子</span><a class="headerlink" href="#id15" title="このテーブルへのパーマリンク">¶</a></caption>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>演算子</p></th>
<th class="head"><p>Fortran 77形式</p></th>
<th class="head"><p>意味</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">&gt;</span>&#160; <span class="pre">B</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">.gt.</span> <span class="pre">B</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code> の方が <code class="docutils literal notranslate"><span class="pre">B</span></code> よりも大きければ真</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">&gt;=</span> <span class="pre">B</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">.ge.</span> <span class="pre">B</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code> が <code class="docutils literal notranslate"><span class="pre">B</span></code> 以上であれば真</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">&lt;</span>&#160; <span class="pre">B</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">.lt.</span> <span class="pre">B</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code> の方が <code class="docutils literal notranslate"><span class="pre">B</span></code> よりも小さければ真</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">&lt;=</span> <span class="pre">B</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">.le.</span> <span class="pre">B</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code> が <code class="docutils literal notranslate"><span class="pre">B</span></code> 以下であれば真</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">==</span> <span class="pre">B</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">.eq.</span> <span class="pre">B</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code> と <code class="docutils literal notranslate"><span class="pre">B</span></code> が厳密に等しければ真</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">/=</span> <span class="pre">B</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">.ne.</span> <span class="pre">B</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">A</span></code> と <code class="docutils literal notranslate"><span class="pre">B</span></code> が等しくなければ真</p></td>
</tr>
</tbody>
</table>
<p>また条件判定が複雑な時には以下の論理演算子を用いることになるだろう．</p>
<table class="colwidths-given docutils align-default" id="id16" style="width: 80%">
<caption><span class="caption-text">論理演算子</span><a class="headerlink" href="#id16" title="このテーブルへのパーマリンク">¶</a></caption>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>演算子</p></th>
<th class="head"><p>意味</p></th>
<th class="head"><p>使い方</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">.and.</span></code></p></td>
<td><p>論理積</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(条件式1)</span> <span class="pre">.and.</span> <span class="pre">(条件式2)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">.or.</span></code></p></td>
<td><p>論理和</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(条件式1)</span> <span class="pre">.or.</span>&#160; <span class="pre">(条件式2)</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">.not.</span></code></p></td>
<td><p>否定</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.not.</span> <span class="pre">(条件式)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">.eqv.</span></code></p></td>
<td><p>論理等価</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(条件式1)</span> <span class="pre">.eqv.</span> <span class="pre">(条件式2)</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">.neqv.</span></code></p></td>
<td><p>論理非等価</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(条件式1)</span> <span class="pre">.neqv.</span> <span class="pre">(条件式2)</span></code></p></td>
</tr>
</tbody>
</table>
<p>使い方は例えば</p>
<div class="highlight-fortran notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">integer</span> <span class="kd">::</span> <span class="n">n</span>

<span class="k">if</span> <span class="p">(</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">n</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">5</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">  write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;n is larger than 2 and smaller than 5&#39;</span>
<span class="k">end if</span>
</pre></div>
</td></tr></table></div>
<p>と言った具合である．<code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">&lt;</span> <span class="pre">n</span> <span class="pre">&lt;</span> <span class="pre">5</span></code> のような数学的な書き方はできないので注意が必要である．</p>
<p>さらに複雑な条件分岐の場合には以下のように <code class="docutils literal notranslate"><span class="pre">if</span></code> 文を入れ子で使うことも出来る．</p>
<div class="highlight-fortran notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span> <span class="n">conditional</span> <span class="mi">1</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">  if</span> <span class="p">(</span> <span class="n">conditional</span> <span class="mi">2</span> <span class="p">)</span> <span class="k">then</span>
    <span class="c">! 処理1</span>
  <span class="k">else</span>
    <span class="c">! 処理2</span>
  <span class="k">end if</span>
<span class="k">end if</span>
</pre></div>
</td></tr></table></div>
<p>ただし何重にも深く入れ子になった <code class="docutils literal notranslate"><span class="pre">if</span></code> 文の実行効率はあまり良くないので出来るかぎり浅い条件分岐に留めておいた方が良い．</p>
<p>以下は <a class="reference internal" href="chap04_sample1_f90.html"><span class="doc">sample1.f90</span></a> の11-19行目の閏年の判定と全く同じことを入れ子にした <code class="docutils literal notranslate"><span class="pre">if</span></code> で実装した例である．</p>
<div class="literal-block-wrapper docutils container" id="id17">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="chap04_sample1_f90.html"><span class="doc">sample1.f90</span></a> 抜粋</span><a class="headerlink" href="#id17" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-fortran notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>21
22
23
24
25
26
27
28
29
30
31
32
33
34</pre></div></td><td class="code"><div class="highlight"><pre><span></span>  <span class="c">! 同じことを入れ子のifで実現</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">mod</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">     if</span> <span class="p">(</span><span class="nb">mod</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        if</span> <span class="p">(</span><span class="nb">mod</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">           write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Leap year&#39;</span>
        <span class="k">else</span>
<span class="k">           write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Common year&#39;</span>
        <span class="k">end if</span>
<span class="k">     else</span>
<span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Leap year&#39;</span>
     <span class="k">end if</span>
<span class="k">  else</span>
<span class="k">     write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Common year&#39;</span>
  <span class="k">end if</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="do">
<h2><a class="toc-backref" href="#id29"><span class="section-number">4.2. </span>反復処理(do)</a><a class="headerlink" href="#do" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="section" id="c4-do">
<span id="id4"></span><h3><span class="section-number">4.2.1. </span>決まった回数の繰り返し(do)<a class="headerlink" href="#c4-do" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>決まった繰り返しの処理をするために用いるのが <code class="docutils literal notranslate"><span class="pre">do</span></code> (従ってこの反復処理は <code class="docutils literal notranslate"><span class="pre">do</span></code> ループと呼ばれる)である．これも使い方は至ってシンプルである．</p>
<div class="literal-block-wrapper docutils container" id="id18">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="chap04_sample2_f90.html"><span class="doc">sample2.f90</span></a> 抜粋</span><a class="headerlink" href="#id18" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-fortran notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span></span>  <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;--- Do loop #1 ---&#39;</span>
  <span class="nb">sum</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span>
     <span class="nb">sum</span> <span class="o">=</span> <span class="nb">sum</span> <span class="o">+</span> <span class="n">i</span>
     <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">i</span><span class="p">,</span> <span class="nb">sum</span>
<span class="nb">  </span><span class="k">end do</span>
</pre></div>
</td></tr></table></div>
</div>
<p>は1から10までの和を順次求めながら結果を出力している．より一般には</p>
<div class="highlight-fortran notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">,</span> <span class="n">stride</span>
  <span class="c">! 繰り返し処理</span>
<span class="k">end do</span>
</pre></div>
</td></tr></table></div>
<p>のような形で書くことになる．上の例では整数型変数 <code class="docutils literal notranslate"><span class="pre">i</span></code> は <code class="docutils literal notranslate"><span class="pre">do</span></code> 変数と呼ばれ，<code class="docutils literal notranslate"><span class="pre">do</span></code> ループの中で <code class="docutils literal notranslate"><span class="pre">i</span></code> の値が <code class="docutils literal notranslate"><span class="pre">lower</span></code> から <code class="docutils literal notranslate"><span class="pre">upper</span></code> まで <code class="docutils literal notranslate"><span class="pre">stride</span></code> ずつ変化する．<code class="docutils literal notranslate"><span class="pre">stride</span></code> は省略することも可能であり，その場合は <code class="docutils literal notranslate"><span class="pre">1</span></code> と解釈される．また <code class="docutils literal notranslate"><span class="pre">stride</span></code> は負の値であっても良い(当然この時は <code class="docutils literal notranslate"><span class="pre">lower</span> <span class="pre">&gt;</span> <span class="pre">upper</span></code> でなければループ内の処理は実行されない)．通常 <code class="docutils literal notranslate"><span class="pre">do</span></code> 変数は整数型でなければならないが，実数型などでもコンパイル出来てしまう環境もあり，そのような場合は思わぬバグの原因となってしまう．間違いを未然に防ぐためにも <code class="docutils literal notranslate"><span class="pre">do</span></code> 変数には整数型を用いること．</p>
<p>例えば次は先ほどの例の和を求める処理を1つおきに実行する．</p>
<div class="literal-block-wrapper docutils container" id="id19">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="chap04_sample2_f90.html"><span class="doc">sample2.f90</span></a> 抜粋</span><a class="headerlink" href="#id19" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-fortran notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>18
19
20
21
22
23</pre></div></td><td class="code"><div class="highlight"><pre><span></span>  <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;--- Do loop #2 ---&#39;</span>
  <span class="nb">sum</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span>
     <span class="nb">sum</span> <span class="o">=</span> <span class="nb">sum</span> <span class="o">+</span> <span class="n">i</span>
     <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">i</span><span class="p">,</span> <span class="nb">sum</span>
<span class="nb">  </span><span class="k">end do</span>
</pre></div>
</td></tr></table></div>
</div>
<p>また <code class="docutils literal notranslate"><span class="pre">if</span></code> 文の場合と同様に <code class="docutils literal notranslate"><span class="pre">do</span></code> ループに関しても以下のように入れ子(多重ループ)にすることが出来る．以下は2重ループの例である．</p>
<div class="literal-block-wrapper docutils container" id="id20">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="chap04_sample2_f90.html"><span class="doc">sample2.f90</span></a> 抜粋</span><a class="headerlink" href="#id20" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-fortran notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>34
35
36
37
38
39</pre></div></td><td class="code"><div class="highlight"><pre><span></span>  <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;--- Do loop #4 ---&#39;</span>
  <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span>
     <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span>
        <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;(&#39;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="s1">&#39;) =&gt; &#39;</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">j</span>
     <span class="k">end do</span>
<span class="k">  end do</span>
</pre></div>
</td></tr></table></div>
</div>
<p>この部分の実行結果は以下のようになる．</p>
<div class="highlight-bash notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span>--- Do loop <span class="c1">#4 ---</span>
 <span class="o">(</span>           <span class="m">1</span> ,           <span class="m">1</span> <span class="o">)</span> <span class="o">=</span>&gt;            <span class="m">1</span>
 <span class="o">(</span>           <span class="m">1</span> ,           <span class="m">2</span> <span class="o">)</span> <span class="o">=</span>&gt;            <span class="m">2</span>
 <span class="o">(</span>           <span class="m">1</span> ,           <span class="m">3</span> <span class="o">)</span> <span class="o">=</span>&gt;            <span class="m">3</span>
 <span class="o">(</span>           <span class="m">2</span> ,           <span class="m">1</span> <span class="o">)</span> <span class="o">=</span>&gt;            <span class="m">4</span>
 <span class="o">(</span>           <span class="m">2</span> ,           <span class="m">2</span> <span class="o">)</span> <span class="o">=</span>&gt;            <span class="m">5</span>
 <span class="o">(</span>           <span class="m">2</span> ,           <span class="m">3</span> <span class="o">)</span> <span class="o">=</span>&gt;            <span class="m">6</span>
 <span class="o">(</span>           <span class="m">3</span> ,           <span class="m">1</span> <span class="o">)</span> <span class="o">=</span>&gt;            <span class="m">7</span>
 <span class="o">(</span>           <span class="m">3</span> ,           <span class="m">2</span> <span class="o">)</span> <span class="o">=</span>&gt;            <span class="m">8</span>
 <span class="o">(</span>           <span class="m">3</span> ,           <span class="m">3</span> <span class="o">)</span> <span class="o">=</span>&gt;            <span class="m">9</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="do-while">
<h3><span class="section-number">4.2.2. </span>条件を指定した繰り返し(do while)<a class="headerlink" href="#do-while" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>繰り返しの処理には基本的に先ほどの <code class="docutils literal notranslate"><span class="pre">do</span></code> ループを用いれば良いのだが，これを少し違った形式で行う <code class="docutils literal notranslate"><span class="pre">do</span> <span class="pre">while</span></code> なる構文も用意されている．これは</p>
<div class="highlight-fortran notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">do while</span><span class="p">(</span> <span class="n">conditional</span> <span class="p">)</span>
  <span class="c">! 繰り返し処理</span>
<span class="k">end do</span>
</pre></div>
</td></tr></table></div>
<p>のような形で用い，<code class="docutils literal notranslate"><span class="pre">()</span></code> 内の条件式が真( <code class="docutils literal notranslate"><span class="pre">.true.</span></code>)の間は繰り返し処理が行われる．例えば</p>
<div class="highlight-fortran notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span>
<span class="kt">real</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="kd">::</span> <span class="nb">sum</span>

<span class="nb">sum</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">do while</span><span class="p">(</span><span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">10</span><span class="p">)</span>
   <span class="nb">sum</span> <span class="o">=</span> <span class="nb">sum</span> <span class="o">+</span> <span class="n">i</span>
   <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
   <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">i</span><span class="p">,</span> <span class="nb">sum</span>
<span class="k">end do</span>
</pre></div>
</td></tr></table></div>
<p>は先ほどの例 <a class="reference internal" href="chap04_sample3_f90.html"><span class="doc">sample2.f90</span></a> の最初の <code class="docutils literal notranslate"><span class="pre">do</span></code> ループと同じ処理を実行する．この場合はあえて <code class="docutils literal notranslate"><span class="pre">do</span> <span class="pre">while</span></code> を用いる意味はあまり感じられないが，繰り返し回数が予め分からない処理ではこのような形式を用いるとスマートに書ける場面にもしばしば遭遇する．例えば反復計算によって実数型の値の収束判定をする場合などは</p>
<div class="highlight-fortran notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">real</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="kd">::</span> <span class="n">x</span>

<span class="k">do while</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.0e-8_8</span><span class="p">)</span>
  <span class="c">! 繰り返し処理</span>
<span class="k">end do</span>
</pre></div>
</td></tr></table></div>
<p>などのように非常にスッキリと記述できる．この例では <code class="docutils literal notranslate"><span class="pre">abs(x)</span></code> の値が <span class="math notranslate nohighlight">\(10^{-8}\)</span> 以下になるまで反復を続ける．例えば，以下は逐次計算によって平方根を求める計算である．</p>
<div class="literal-block-wrapper docutils container" id="id21">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="chap04_sample3_f90.html"><span class="doc">sample3.f90</span></a> 抜粋</span><a class="headerlink" href="#id21" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-fortran notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>20
21
22
23
24
25
26</pre></div></td><td class="code"><div class="highlight"><pre><span></span>  <span class="c">!</span>
  <span class="c">! 逐次近似によって平方根を求める</span>
  <span class="c">!</span>
  <span class="k">do while</span><span class="p">(</span> <span class="nb">abs</span><span class="p">((</span><span class="n">sqrt_x0</span><span class="o">-</span><span class="n">sqrt_x1</span><span class="p">)</span><span class="o">/</span><span class="n">sqrt_x0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">tolerance</span> <span class="p">)</span>
     <span class="n">sqrt_x0</span> <span class="o">=</span> <span class="p">(</span><span class="n">sqrt_x0</span> <span class="o">+</span> <span class="n">sqrt_x1</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5_8</span>
     <span class="n">sqrt_x1</span> <span class="o">=</span> <span class="n">x</span> <span class="o">/</span> <span class="n">sqrt_x0</span>
  <span class="k">end do</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="exitcycle">
<h3><span class="section-number">4.2.3. </span>複雑な処理(exitとcycle)<a class="headerlink" href="#exitcycle" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>単純な繰り返しだけでなく，より柔軟な制御を行うには <code class="docutils literal notranslate"><span class="pre">exit</span></code> や <code class="docutils literal notranslate"><span class="pre">cycle</span></code> を用いる．<code class="docutils literal notranslate"><span class="pre">exit</span></code> では <code class="docutils literal notranslate"><span class="pre">do</span></code> ループの中から途中で抜けることが出来，<code class="docutils literal notranslate"><span class="pre">cycle</span></code> ではループ内のそれ以降の処理を行わずにループ先頭に戻ることがで出来る．これらを用いると意図的に作った無限ループから条件を満たした時だけ抜け出すようなプログラムも簡単に作ることができる．例えば以下の例を見てみよう．</p>
<div class="literal-block-wrapper docutils container" id="id22">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="chap04_sample4_f90.html"><span class="doc">sample4.f90</span></a> 抜粋</span><a class="headerlink" href="#id22" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-fortran notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28</pre></div></td><td class="code"><div class="highlight"><pre><span></span>  <span class="c">! 無限ループ</span>
  <span class="k">do while</span><span class="p">(</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span> <span class="p">)</span>
     <span class="c">! 標準入力から読み込む</span>
     <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;&#39;</span>
     <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Input a positive integer (less than 10): &#39;</span>
     <span class="k">read</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">increment</span>

     <span class="k">if</span> <span class="p">(</span> <span class="n">increment</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;error : input &lt;= 0&#39;</span>
        <span class="k">exit</span>   <span class="c">! ループを抜ける</span>
     <span class="k">else if</span> <span class="p">(</span> <span class="n">increment</span> <span class="o">&gt;=</span> <span class="mi">10</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;error : input &gt;= 10&#39;</span>
        <span class="k">cycle</span>  <span class="c">! ループの先頭へ(これ以下の処理は行わない)</span>
     <span class="k">end if</span>

     <span class="c">! countを増やす</span>
     <span class="nb">count</span> <span class="o">=</span> <span class="nb">count</span> <span class="o">+</span> <span class="n">increment</span>

     <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;current count = &#39;</span><span class="p">,</span> <span class="nb">count</span>
<span class="nb">  </span><span class="k">end do</span>
</pre></div>
</td></tr></table></div>
</div>
<p>この例では標準入力からの10より小さい正の整数を受け取り，受け取った数の和を求める．ただし0以下の値を受け取った場合は処理を終了する．また，10以上の値受け取った場合はエラーを表示し，和はとらずに無視する．実行結果は例えば以下のようになる．</p>
<div class="highlight-bash notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span>$ ./a.out
 Input a positive integer <span class="o">(</span>less than <span class="m">10</span><span class="o">)</span>:
<span class="m">5</span>                                            <span class="c1"># キーボード入力</span>
 current <span class="nv">count</span> <span class="o">=</span>            <span class="m">5</span>

 Input a positive integer <span class="o">(</span>less than <span class="m">10</span><span class="o">)</span>:
<span class="m">4</span>                                            <span class="c1"># キーボード入力</span>
 current <span class="nv">count</span> <span class="o">=</span>            <span class="m">9</span>

 Input a positive integer <span class="o">(</span>less than <span class="m">10</span><span class="o">)</span>:
<span class="m">10</span>                                            <span class="c1"># キーボード入力</span>
 error : input &gt;<span class="o">=</span> <span class="m">10</span>

 Input a positive integer <span class="o">(</span>less than <span class="m">10</span><span class="o">)</span>:
<span class="m">0</span>                                            <span class="c1"># キーボード入力</span>
 error : input &lt;<span class="o">=</span> <span class="m">0</span>
 last <span class="nv">count</span> <span class="o">=</span>            <span class="m">9</span>
</pre></div>
</td></tr></table></div>
<p>なお，同じ動作を実現する方法は1つとは限らない．例えば <code class="docutils literal notranslate"><span class="pre">while</span></code> の条件判定を <code class="docutils literal notranslate"><span class="pre">increment</span> <span class="pre">&lt;=</span> <span class="pre">0</span></code> と変更すれば，この条件に対応する <code class="docutils literal notranslate"><span class="pre">if</span></code> は必要がなくなる．複数の方法がある場合にはより分かりやすい方(すなわち間違いが発生しにくい方)を採用すれば良い．ちなみに無限ループを作るには <code class="docutils literal notranslate"><span class="pre">while</span> <span class="pre">(.true.)</span></code> は必ずしも必要では無く，</p>
<div class="highlight-fortran notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">do</span>
  <span class="c">! exitで抜けないかぎりここの処理が無限に繰り返される</span>
<span class="k">end do</span>
</pre></div>
</td></tr></table></div>
<p>のように書くことも可能である．</p>
</div>
</div>
<div class="section" id="select">
<h2><a class="toc-backref" href="#id30"><span class="section-number">4.3. </span>条件分岐(select)</a><a class="headerlink" href="#select" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">select</span></code> 構文を用いても条件分岐を行うことも出来る．基本的には <code class="docutils literal notranslate"><span class="pre">if</span></code> を用いれば同じことは実現出来るのだが，場合によっては <code class="docutils literal notranslate"><span class="pre">select</span></code> を用いた方がよりスッキリとした形で書ける事があるので知っておいて損はない．典型的には整数や文字列の値で場合分けを制御する際に用いる(実数型には用いることは出来ない)．</p>
<p>一番基本的な使い方は以下のようなものである．</p>
<div class="literal-block-wrapper docutils container" id="id23">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="chap04_sample5_f90.html"><span class="doc">sample5.f90</span></a> 抜粋</span><a class="headerlink" href="#id23" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-fortran notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></div></td><td class="code"><div class="highlight"><pre><span></span>  <span class="c">! 整数を読み込む</span>
  <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Input integer : &#39;</span>
  <span class="k">read</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">i</span>

  <span class="c">! 整数の値で場合分け</span>
  <span class="k">select case</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
  <span class="k">case</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>        <span class="c">! i == 0 のとき</span>
     <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;your input was zero&#39;</span>
  <span class="k">case</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>        <span class="c">! i == 1 のとき</span>
     <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;your input was one&#39;</span>
  <span class="k">case</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>        <span class="c">! i == 2 のとき</span>
     <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;your input was two&#39;</span>
  <span class="k">case</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>        <span class="c">! i == 3 のとき</span>
     <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;your input was three&#39;</span>
  <span class="k">case </span><span class="n">default</span>   <span class="c">! 上記以外全て</span>
     <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;your input was too large&#39;</span>
  <span class="k">end select</span>
</pre></div>
</td></tr></table></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">case</span></code> で入力された整数の値に応じて処理を切り替えている．また，どの <code class="docutils literal notranslate"><span class="pre">case</span></code> の条件にも当てはまらない場合の処理は <code class="docutils literal notranslate"><span class="pre">case</span> <span class="pre">deafault</span></code> によって行えば良い．</p>
<p>この例を見ただけでは <code class="docutils literal notranslate"><span class="pre">if-elif-else</span></code> を使うのとほとんど変わらないように感じられるので，もう少し <code class="docutils literal notranslate"><span class="pre">select</span></code> の利点が生かされた例として以下を見てみよう．ここでは入力された整数 <code class="docutils literal notranslate"><span class="pre">score</span></code> (テストの点だと思おう)の値によって場合分けをしている．</p>
<div class="literal-block-wrapper docutils container" id="id24">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="chap04_sample5_f90.html"><span class="doc">sample5.f90</span></a> 抜粋</span><a class="headerlink" href="#id24" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-fortran notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44</pre></div></td><td class="code"><div class="highlight"><pre><span></span>  <span class="c">! 点数を読み込む</span>
  <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;&#39;</span>
  <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Input score : &#39;</span>
  <span class="k">read</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">score</span>

  <span class="k">select case</span><span class="p">(</span><span class="n">score</span><span class="p">)</span>
  <span class="k">case</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>              <span class="c">! 0点</span>
     <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;zero&#39;</span>
  <span class="k">case</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">29</span><span class="p">)</span>           <span class="c">! 1-29点</span>
     <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;poor&#39;</span>
  <span class="k">case</span><span class="p">(</span><span class="mi">30</span><span class="p">:</span><span class="mi">59</span><span class="p">)</span>          <span class="c">! 30-59点</span>
     <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;fair&#39;</span>
  <span class="k">case</span><span class="p">(</span><span class="mi">60</span><span class="p">:</span><span class="mi">89</span><span class="p">)</span>          <span class="c">! 60-89点</span>
     <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;good&#39;</span>
  <span class="k">case</span><span class="p">(</span><span class="mi">90</span><span class="p">:</span><span class="mi">100</span><span class="p">)</span>         <span class="c">! 90-100点</span>
     <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;excellent&#39;</span>
  <span class="k">case </span><span class="n">default</span>         <span class="c">! それ以外</span>
     <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;invalid input&#39;</span>
  <span class="k">end select</span>
</pre></div>
</td></tr></table></div>
</div>
<p>この例のように <code class="docutils literal notranslate"><span class="pre">case</span></code> では単一の値だけでなく値の範囲を指定することができる．範囲の指定は <code class="docutils literal notranslate"><span class="pre">case(下限:上限)</span></code> のような形ですれば良い．</p>
<p>さらに</p>
<div class="literal-block-wrapper docutils container" id="id25">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="chap04_sample5_f90.html"><span class="doc">sample5.f90</span></a> 抜粋</span><a class="headerlink" href="#id25" title="このコードへのパーマリンク">¶</a></div>
<div class="highlight-fortran notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62</pre></div></td><td class="code"><div class="highlight"><pre><span></span>  <span class="c">! 文字列を読み込む</span>
  <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;&#39;</span>
  <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Input language : &#39;</span>
  <span class="k">read</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">c</span>

  <span class="c">! 文字列の値で場合分け</span>
  <span class="k">select case</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c++&#39;</span><span class="p">,</span> <span class="s1">&#39;fortran&#39;</span><span class="p">)</span>
     <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;compiled language&#39;</span>
  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;python&#39;</span><span class="p">,</span> <span class="s1">&#39;perl&#39;</span><span class="p">,</span> <span class="s1">&#39;ruby&#39;</span><span class="p">)</span>
     <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;script language&#39;</span>
  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;english&#39;</span><span class="p">,</span> <span class="s1">&#39;japanese&#39;</span><span class="p">,</span> <span class="s1">&#39;french&#39;</span><span class="p">,</span> <span class="s1">&#39;chinese&#39;</span><span class="p">)</span>
     <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;natural language&#39;</span>
  <span class="k">case </span><span class="n">default</span>
     <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;others&#39;</span>
  <span class="k">end select</span>
</pre></div>
</td></tr></table></div>
</div>
<p>は文字列の値によって分岐する例である．このように1つの <code class="docutils literal notranslate"><span class="pre">case</span></code> で複数の値をカンマで区切って指定することも出来る．</p>
</div>
<div class="section" id="id5">
<h2><a class="toc-backref" href="#id31"><span class="section-number">4.4. </span>第4章 演習課題</a><a class="headerlink" href="#id5" title="このヘッドラインへのパーマリンク">¶</a></h2>
<blockquote>
<div><p><a class="reference external" href="chap04_kadai.pdf">課題PDFダウンロード</a></p>
</div></blockquote>
<div class="section" id="id6">
<h3><span class="section-number">4.4.1. </span>課題1<a class="headerlink" href="#id6" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>サンプルプログラムをコンパイル・実行して動作を確認せよ．さらに，適宜修正してその実行結果を確認せよ．</p>
</div>
<div class="section" id="id7">
<h3><span class="section-number">4.4.2. </span>課題2<a class="headerlink" href="#id7" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>標準入力から2つの整数( <span class="math notranslate nohighlight">\(n, m\)</span> とする)を読み込み，その大小を比較するプログラムを作成せよ．例えば <span class="math notranslate nohighlight">\(n = 1, m = 2\)</span> なら以下のように <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">is</span> <span class="pre">smaller</span> <span class="pre">than</span> <span class="pre">2</span></code> と表示する．</p>
<div class="highlight-bash notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span>$./a.out
 Input two integers:
<span class="m">1</span>    <span class="c1"># キーボード入力</span>
<span class="m">2</span>    <span class="c1"># キーボード入力</span>
           <span class="m">1</span>  is smaller than            <span class="m">2</span>
</pre></div>
</td></tr></table></div>
<p>同様に <span class="math notranslate nohighlight">\(n = 2, m = 1\)</span> なら <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">is</span> <span class="pre">larger</span> <span class="pre">than</span> <span class="pre">1</span></code>, <span class="math notranslate nohighlight">\(n = m = 1\)</span> なら <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">is</span> <span class="pre">equal</span> <span class="pre">to</span> <span class="pre">1</span></code> などと表示するものとする．</p>
</div>
<div class="section" id="id8">
<h3><span class="section-number">4.4.3. </span>課題3<a class="headerlink" href="#id8" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p><span class="math notranslate nohighlight">\(0^\circ\)</span> から <span class="math notranslate nohighlight">\(180^\circ\)</span> まで <span class="math notranslate nohighlight">\(10^\circ\)</span> 刻みの <span class="math notranslate nohighlight">\(\theta\)</span> および， <span class="math notranslate nohighlight">\(\sin \theta\)</span>, <span class="math notranslate nohighlight">\(\cos \theta\)</span> を標準出力に表示するプログラムを作成せよ(以下のように各 <span class="math notranslate nohighlight">\(\theta\)</span> の値ごとに改行せよ)．またこの結果をリダイレクトを用いてファイルとして記録し，gnuplotを用いてこのファイルのデータとgnuplotに組み込みの三角関数を共に図示せよ．なお三角関数の引数はラジアン単位であることに注意せよ．</p>
<p>実行結果は例えば以下のようなものになる．</p>
<div class="highlight-bash notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span>$ ./a.out
   <span class="m">0</span>.0000000000000000        <span class="m">0</span>.0000000000000000        <span class="m">1</span>.0000000000000000
   <span class="m">10</span>.000000000000000       <span class="m">0</span>.17364817766693033       <span class="m">0</span>.98480775301220802
   ... 省略 ...
   <span class="m">170</span>.00000000000000       <span class="m">0</span>.17364817766693069      -0.98480775301220802
   <span class="m">180</span>.00000000000000        <span class="m">1</span>.2246467991473532E-016  -1.0000000000000000
</pre></div>
</td></tr></table></div>
<p>以下のようにリダイレクトでデータファイルを作成した場合には</p>
<div class="highlight-bash notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>$ ./a.out &gt; data.dat
</pre></div>
</td></tr></table></div>
<p>gnuplotでは</p>
<div class="highlight-bash notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span>&gt; plot   <span class="s1">&#39;data.dat&#39;</span> using <span class="m">1</span>:2 w lp, sin<span class="o">(</span>x/180*pi<span class="o">)</span>
&gt; replot <span class="s1">&#39;data.dat&#39;</span> using <span class="m">1</span>:3 w lp, cos<span class="o">(</span>x/180*pi<span class="o">)</span>
</pre></div>
</td></tr></table></div>
<p>などとして結果を確認すればよい．</p>
</div>
<div class="section" id="id9">
<h3><span class="section-number">4.4.4. </span>課題4<a class="headerlink" href="#id9" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>標準入力から与えられた2つの整数<span class="math notranslate nohighlight">\(m, n \ge 1\)</span> の最大公約数を表示するプログラムを作成せよ．最大公約数を求めるには以下のアルゴリズム(ユークリッドの互除法)を用いるとよい．</p>
<blockquote>
<div><ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(m\)</span> を <span class="math notranslate nohighlight">\(n\)</span> で割った余り <span class="math notranslate nohighlight">\(r\)</span> を求める．</p></li>
<li><p>もし <span class="math notranslate nohighlight">\(r = 0\)</span> ならば <span class="math notranslate nohighlight">\(n\)</span> が最大公約数である．</p></li>
<li><p>もし <span class="math notranslate nohighlight">\(r \neq 0\)</span> ならば， <span class="math notranslate nohighlight">\(m\)</span> に <span class="math notranslate nohighlight">\(n\)</span> を， <span class="math notranslate nohighlight">\(n\)</span> に <span class="math notranslate nohighlight">\(r\)</span> を代入して[1]に戻る(繰り返す)．</p></li>
</ol>
</div></blockquote>
<p>実行結果は例えば以下のようなものになる．</p>
<div class="highlight-bash notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span>$ ./a.out
<span class="m">12</span>
<span class="m">20</span>
 Greatest common divisor :            <span class="m">4</span>
</pre></div>
</td></tr></table></div>
<p>なお，組み込み関数 <code class="docutils literal notranslate"><span class="pre">mod</span></code> を用いて</p>
<div class="highlight-fortran notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="nb">mod</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>とすれば <code class="docutils literal notranslate"><span class="pre">m</span></code> を <code class="docutils literal notranslate"><span class="pre">n</span></code> で割った余りを <code class="docutils literal notranslate"><span class="pre">r</span></code> に代入することが出来る．</p>
</div>
<div class="section" id="id10">
<h3><span class="section-number">4.4.5. </span>課題5<a class="headerlink" href="#id10" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>以下の級数計算により自然対数の底 <span class="math notranslate nohighlight">\(e\)</span> の近似値を求めるプログラムを作成せよ．</p>
<div class="math notranslate nohighlight">
\[e \simeq \sum_{n=0}^{N} \frac{1}{n !}. \quad (0! = 1に注意せよ)\]</div>
<p>ただし以下の条件を満たすこと．</p>
<blockquote>
<div><ul class="simple">
<li><p>上式の <span class="math notranslate nohighlight">\(N\)</span> および許容誤差 <span class="math notranslate nohighlight">\(\epsilon\)</span> を標準入力から読み込む．</p></li>
<li><p><span class="math notranslate nohighlight">\(N &gt; 1\)</span> でない場合および <span class="math notranslate nohighlight">\(0 &lt; \epsilon &lt; 1\)</span> でない場合にはエラーメッセージを表示して終了する．</p></li>
<li><p>誤差が <span class="math notranslate nohighlight">\(\epsilon\)</span> 以下になった時点か， <span class="math notranslate nohighlight">\(n = N\)</span> まで計算した時点で級数計算を打ち切る．</p></li>
<li><p>最後に収束したかどうか，最終的な項数 <span class="math notranslate nohighlight">\(n\)</span> ，真値，近似値，相対誤差を表示して終了する．</p></li>
</ul>
</div></blockquote>
<p>実行結果は例えば以下のようなものになる．</p>
<div class="highlight-bash notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span>$ ./a.out
<span class="m">10</span>          <span class="c1"># キーボード入力</span>
<span class="m">1</span>.0e-8      <span class="c1"># キーボード入力</span>
 Did not converge !
 N                  :           <span class="m">10</span>
 Exact value        :    <span class="m">2</span>.7182818284590451
 Approximated value :    <span class="m">2</span>.7182818011463845
 Error              :   <span class="m">1</span>.00477663102110533E-008
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id11">
<h3><span class="section-number">4.4.6. </span>課題6<a class="headerlink" href="#id11" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>標準入力から文字列(英単語)を読み込み，それが <code class="docutils literal notranslate"><span class="pre">food</span></code>, <code class="docutils literal notranslate"><span class="pre">animal</span></code>, <code class="docutils literal notranslate"><span class="pre">vehicle</span></code>, <code class="docutils literal notranslate"><span class="pre">others</span></code> (それ以外)のいずれかを判定し，表示するプログラムを作成せよ．ただし <code class="docutils literal notranslate"><span class="pre">exit</span></code> が入力されるまでプログラムは終了せず何度でも入力を受け付けるものとする．なお以下の英単語リスト以外のものは <code class="docutils literal notranslate"><span class="pre">others</span></code> と判断してよい:
<code class="docutils literal notranslate"><span class="pre">apple</span></code>, <code class="docutils literal notranslate"><span class="pre">orange</span></code>, <code class="docutils literal notranslate"><span class="pre">banana</span></code>, <code class="docutils literal notranslate"><span class="pre">dog</span></code>, <code class="docutils literal notranslate"><span class="pre">cat</span></code>, <code class="docutils literal notranslate"><span class="pre">lion</span></code>, <code class="docutils literal notranslate"><span class="pre">car</span></code>,
<code class="docutils literal notranslate"><span class="pre">airplane</span></code>, <code class="docutils literal notranslate"><span class="pre">motorcycle</span></code> ．</p>
<p>実行結果は例えば以下のようなものになる．</p>
<div class="highlight-bash notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span></span>$ ./a.out
apple    <span class="c1"># キーボード入力</span>
 food
cat      <span class="c1"># キーボード入力</span>
 animal
car      <span class="c1"># キーボード入力</span>
 vehicle
dog      <span class="c1"># キーボード入力</span>
 animal
airplane <span class="c1"># キーボード入力</span>
 vehicle
bike     <span class="c1"># キーボード入力</span>
 others
<span class="nb">exit</span>     <span class="c1"># キーボード入力</span>
 Now <span class="nb">exit</span> program...
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id12">
<h3><span class="section-number">4.4.7. </span>課題7<a class="headerlink" href="#id12" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>以下の漸化式</p>
<div class="math notranslate nohighlight">
\[p_{n+1} = p_n + \alpha p_n (1 - p_n)\]</div>
<p>で定義される数列 <span class="math notranslate nohighlight">\(p_n (n=0, 1, \ldots)\)</span> を考える．初期値 <span class="math notranslate nohighlight">\(p_0 = 0.9\)</span> から数列を生成し，そのうち <span class="math notranslate nohighlight">\(n=100, \ldots, 200\)</span> までを <span class="math notranslate nohighlight">\(\alpha\)</span> の関数として <span class="math notranslate nohighlight">\(1 &lt; \alpha &lt; 3\)</span> の範囲でプロットせよ． <span class="math notranslate nohighlight">\(\alpha\)</span> を <span class="math notranslate nohighlight">\(10^{-3}\)</span> 刻みで変えながらプロットすると結果は以下のようになるだろう．</p>
<div class="figure align-center" id="id26">
<a class="reference internal image-reference" href="_images/logistic.png"><img alt="_images/logistic.png" src="_images/logistic.png" style="width: 480.0px; height: 360.0px;" /></a>
<p class="caption"><span class="caption-text">ロジスティック写像</span><a class="headerlink" href="#id26" title="この画像へのパーマリンク">¶</a></p>
</div>
<p>このような写像はロジスティック写像と呼ばれ，非常に単純な式ながら一定の条件を満たすときにはカオスを生み出すことが知られている．</p>
<hr class="docutils" />
<dl class="footnote brackets">
<dt class="label" id="id13"><span class="brackets"><a class="fn-backref" href="#id3">1</a></span></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">abs(x)</span></code> は <code class="docutils literal notranslate"><span class="pre">x</span></code> の絶対値を返す組込み関数である．</p>
</dd>
</dl>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="総合索引"
             >索引</a></li>
        <li class="right" >
          <a href="chap05.html" title="5. 配列"
             >次へ</a> |</li>
        <li class="right" >
          <a href="chap03.html" title="3. 変数・データ型・基本的な計算"
             >前へ</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Fortran演習</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, Takanobu Amano.
      このドキュメントは <a href="http://sphinx-doc.org/">Sphinx</a> 3.0.3 で生成しました。
    </div>
  </body>
</html>